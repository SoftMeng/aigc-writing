#!/usr/bin/env python3
"""
批量生成第53章角色战斗图片
"""

import os
import sys
from pathlib import Path

# 添加脚本路径
script_dir = Path(__file__).parent.parent.parent.parent
sys.path.insert(0, str(script_dir / ".claude/skills/comfyui-image-generation/scripts"))

from generate import generate_image

# 第53章角色战斗提示词
characters = {
    "卡芙卡": """竖图格式战斗场景。深夜的霓虹战场，紫色与黑色交织的赛博朋克空间。卡芙卡以极具侵略性的战斗姿态立于画面中央，身体微微前倾约15度，形成蓄势待发的压迫感。她单手握持那把改造后的能量冲锋枪，枪身散发着幽紫色光芒，枪管上刻有复杂的星穹铁道符文。另一只手轻轻拂过枪身，动作轻柔却充满掌控力。她的眼神是最致命的武器——半眯着的眼睛里闪烁着玩味的光芒，嘴角微微上扬，勾勒出慵懒却危险的笑容。紫黑色睫毛微微颤动，额前的几缕发丝被能量场吹起。黑色短外套在战斗中微微敞开，露出里面白色丝绸衬衫。黑色腿袜边缘的紫色条纹在战斗中发出微光。画面采用伦勃朗光效，左侧脸庞处于阴影中，右侧被紫色光芒照亮。电影级摄影技术，低角度仰拍增强压迫感。胶片颗粒感叠加暖调光晕，线条流畅利落，兼具写实质感与艺术朦胧美。""",

    "希儿": """竖图格式战斗场景。破碎的异空间战场，粉白色的光芒与暗影交错。希儿以灵动飘逸的战斗姿态呈现，身体轻盈地悬空约30厘米，双腿微曲呈备战姿态。粉色短发在能量场中根根分明，向上飞扬。她双手紧握那把巨大的量子镰刀，刀身由粉色能量构成，刀刃长达150厘米，呈现不规则的晶体结构。镰刀挥动时，周围的空间都在扭曲，形成粉色的空间涟漪。她的表情是战斗中的专注与活力的完美结合，眼睛睁得大大的，粉色瞳孔中倒映着战场的光芒，闪烁着坚定的决心。嘴角微微上扬，露出战斗中的兴奋与期待。白色连衣裙在战斗中猎猎作响，裙摆被能量场吹起。梦幻柔光效果，从角色为中心向外扩散。电影级摄影技术，中景仰拍捕捉动感与优雅。""",

    "符玄": """竖图格式战斗场景。神圣的金白色光芒交织。符玄以端庄威严的战斗姿态呈现，身体挺拔如松，右手举起法器指向斜上方45度，左手掐诀置于胸前。白色长发在能量场中缓缓飘动。她双手托举那件巨大的法器，这是一件融合了古典与现代科技的命运占卜仪。法器主体为白玉材质，呈八角形，每一角都镶嵌着不同颜色的宝石。法器周围环绕着旋转的金色星砂。她的表情是神圣与慈悲的完美结合，眼睛微微闭着，睫毛修长，眉头舒展，显示出内心的平静与坚定。嘴角微微上扬，露出慈悲的微笑。白色长袍在战斗中无风自动，内衬是轻柔的白纱。神圣光效从上方倾泻而下。电影级摄影技术，正面平视展现神圣气质。胶片质感增添复古神圣感。""",

    "阿卡丽": """竖图格式战斗场景。阴影笼罩的忍者战场，暗红色与黑色交织。阿卡丽以极速突袭的战斗姿态呈现，身体微微下蹲，形成弹簧般的蓄势待发姿态。右手紧握苦无，准备投掷。黑色长发在身后如瀑布般散开。她手中的苦无由特殊合金打造，刃长18厘米，呈十字形设计。苦无表面刻有古老的忍者符文，每一道划痕都在吸收周围的暗影能量。她的表情是冷酷与专注的完美结合，眼睛微微眯起，黑色瞳孔中闪烁着冰冷的杀意。嘴角紧抿成一条直线，没有任何感情色彩。黑色战斗服完美勾勒出矫健的身姿。暗影光效，角色处于半明半暗的光影交界处。电影级摄影技术，低角度仰拍增强速度感与力量感。""",

    "卡莎": """竖图格式战斗场景。虚空能量肆虐的战场，紫色光芒从裂缝中喷射而出。卡莎以火力全开的战斗姿态呈现，身体微微后仰，形成开枪的后坐力姿态。双手紧握机枪，呈射击姿态。紫色短发在虚空能量中根根倒竖。她手中的机枪由虚空科技打造，枪身长约120厘米，整体呈流线型设计。枪管上刻有虚空符文，枪身有多个能量核心，散发出强烈的紫色光芒。枪口凝聚着旋转的虚空能量弹。她的表情是战斗中的狂野与兴奋，眼睛睁得极大，紫色瞳孔中闪烁着疯狂的光芒。嘴角大大上扬，露出狂野的笑容。紫色紧身战斗服完美贴合身体。虚空光效，强烈的紫色光芒照亮角色。电影级摄影技术，正面平视展现火力全开姿态。""",

    "金克丝": """竖图格式战斗场景。混乱与疯狂并存的战场，蓝色与粉色交织的霓虹光芒。金克丝以极度疯狂的战斗姿态呈现，身体扭曲形成夸张的S曲线。单手叉腰，另一只手扛着巨大的火箭筒。蓝色马尾辫在身后高高扬起。她肩扛的火箭筒由废弃金属拼凑而成，筒身涂装为蓝粉相间的迷彩。火箭筒尾部有特殊的喷口设计，发射时会形成蓝色的火焰尾迹。她的表情是疯狂的极致体现，眼睛睁得极大，蓝色瞳孔中闪烁着疯狂的光芒。嘴角大大咧开，笑容夸张到几乎扭曲。蓝色战斗服有多处破损与烧焦痕迹。爆炸光效，火箭筒发射时的尾焰照亮角色。电影级摄影技术，低角度仰拍增强疯狂感与压迫感。""",

    "优香": """竖图格式战斗场景。宁静却暗藏杀机的战场，白色与蓝色的光芒交织。优香以半跪姿态进行狙击，右膝跪地，左腿在前支撑。身体微微前倾，形成稳定的狙击姿态。双手托举狙击步枪，眼睛贴在瞄准镜上。金色长发束成马尾垂落在背后。她手中的狙击步枪采用高精度工程塑料与金属混合材质，枪身长约150厘米，枪管表面有冷兵器般的金属光泽。瞄准镜为高倍率光学镜筒。她的表情是冷静与紧张的完美结合，眼睛微微眯起锁定目标，眉头轻锁，显示出专注与谨慎。嘴角微微抿紧，有令人安心的坚定。白色战斗外套略显宽松，却不失专业感。冷冽光效，瞄准镜的反光照亮面部。电影级摄影技术，侧面45度角展现狙击姿态。""",

    "星野": """竖图格式战斗场景。废墟中的战斗场景，粉色与白色的光芒交织。星野以极其慵懒却充满力量的战斗姿态呈现，身体微微后仰，单手叉腰，另一只手随意地举着散弹枪。她手中的散弹枪经过个性改造，枪身长约90厘米，采用流线型设计。枪管为双管设计，散射范围广。枪身涂装为粉色，有白色的星形图案装饰。她的表情是慵懒与危险的完美结合，眼睛半睁着，粉色瞳孔中闪烁着慵懒的光芒。嘴角微微上扬，露出一抹漫不经心的微笑。粉色连衣裙在战斗中轻轻飘动。温柔光效，枪口的光芒照亮角色。电影级摄影技术，正面平视展现慵懒姿态。""",

    "爱丽丝": """竖图格式战斗场景。童话与战斗交织的异空间，白色与粉色的光芒交织。爱丽丝以极其可爱的战斗姿态呈现，身体轻轻扭转形成优美的S曲线。双手背在身后，看似无害却握紧了冲锋枪。白色短发在能量场中微微飘动。她手中的冲锋枪融合了童话元素，枪身长约70厘米，整体设计如同童话中的魔法棒。枪管为水晶材质，透明发光。枪身有精美的蕾丝装饰。她的表情是可爱的极致体现，眼睛睁得大大的，白色瞳孔中闪烁着纯真的光芒。嘴角大大上扬，露出灿烂的笑容，如同天使般纯洁。白色连衣裙在战斗中轻轻飘动。梦幻光效，冲锋枪的光芒照亮角色。电影级摄影技术，正面平视展现可爱表情。""",

    "珂蕾妲": """竖图格式战斗场景。烈焰燃烧的战场，红色与金色的光芒交织。珂蕾妲以极其霸气的战斗姿态呈现，身体微微后仰，形成劈砍的蓄势姿态。右手紧握大剑高举过头顶。红色长发在身后如火焰般飞扬。她手中的大剑由烈焰与钢铁打造，剑身长约180厘米，宽约30厘米。剑身采用特殊合金，表面有复杂的锻造纹路如同龙鳞纹理。剑身涂装为血红色，有金色纹路装饰。大剑挥舞时，周围有火焰环绕。她的表情是霸气与冷酷的完美结合，眼睛睁得大大的，红色瞳孔中闪烁着狂野的光芒。眉头紧锁，形成锐利的折线。嘴角微微上扬，露出一抹冷酷的笑容。红色战斗外套在火焰中猎猎作响。烈焰光效，大剑挥舞时的火焰照亮角色。电影级摄影技术，低角度仰拍增强霸气感与力量感。""",

    "安比": """竖图格式战斗场景。阴影与紫色交织的战场，紫色与黑色的光芒交错。安比以极其冷静的战斗姿态呈现，身体微微下蹲，形成潜伏的猎豹姿态。右手反握匕首置于身后，准备突袭。紫色短发在阴影中微微飘动。她手中的匕首由虚空科技与古老锻造术结合，匕首全长约40厘米，刃长25厘米，呈优雅的弧线形设计。刀刃表面有紫色幽光涂层，能够在黑暗中隐形。匕首挥舞时，会在空气中留下紫色的尾迹。她的表情是冷静与专注的极致体现，眼睛微微眯起，紫色瞳孔中闪烁着冰冷的光芒。嘴角紧抿成一条直线，没有任何表情。紫色战斗服完美贴合身体。阴影光效，匕首的光芒从侧面照亮角色。电影级摄影技术，侧面45度角展现冷静姿态。"""
}

def main():
    """批量生成战斗图片"""

    output_dir = "/Users/xiangyuanmeng/Documents/TowerProject2/aigc-writing/我逛漫展的那些年/插图/第053章"

    print(f"开始生成第53章角色战斗图片...")
    print(f"输出目录: {output_dir}")
    print(f"角色数量: {len(characters)}")
    print("-" * 60)

    success_count = 0
    failed_count = 0

    for i, (name, prompt) in enumerate(characters.items()):
        try:
            print(f"\n[{i+1}/{len(characters)}] 正在生成 {name} 的战斗图片...")

            saved_paths = generate_image(
                prompt=prompt,
                width=768,
                height=1536,  # 竖图格式
                steps=20,
                sampler="er_sde",
                scheduler="normal",
                lora="nsfw_v1.safetensors",
                lora_weight=0.8,
                output_dir=output_dir,
                server_address="localhost:8188",
                image_prefix=f"第053章_{name}_战斗"
            )

            for path in saved_paths:
                print(f"  已保存: {path}")

            success_count += 1

        except Exception as e:
            print(f"  错误: {e}")
            failed_count += 1

    print("\n" + "=" * 60)
    print(f"生成完成！成功: {success_count}, 失败: {failed_count}")
    print("=" * 60)

if __name__ == "__main__":
    main()
